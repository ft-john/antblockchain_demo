"use strict";var RLP=require("rlp"),paramUtil=require("./param"),Buffer=require("safe-buffer").Buffer,HEADER_LEN=16;module.exports={HEADER_LEN:HEADER_LEN,makeTlsPacket:function(e){Array.isArray(e)&&(e=this._rlp_encode(e));var r=HEADER_LEN+e.length,t=Buffer.alloc(HEADER_LEN);return t.writeInt32BE(r,0),t.writeInt16BE(2,4),t.writeInt8(51,6),t.writeInt8(119,7),t.writeInt32BE(0,8),t.writeInt32BE(0,12),Buffer.concat([t,e],r)},getTotalLength:function(e){return e.readInt32BE(0)},getTlsPacket:function(e,r){return{total_len:this.getTotalLength(e),version:e.readInt16BE(4),magic1:e.readInt8(6),magic2:e.readInt8(7),reserved1:e.readInt32BE(8),reserved2:e.readInt32BE(12),data:this.rlp_decode(r)}},_rlp_encode:function(e){return RLP.encode(e)},rlp_encode:function(e,r){return paramUtil.bufferToHex(this._rlp_encode(e),r)},rlp_decode:function(e){return RLP.decode(e)}};